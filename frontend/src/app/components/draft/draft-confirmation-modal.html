<div class="final-confirmation-overlay" *ngIf="isVisible" (click)="closeModal()" (keydown.escape)="closeModal()">
  <div class="final-confirmation-modal" (click)="$event.stopPropagation()" (keydown)="$event.stopPropagation()">>
    <!-- Header -->
    <div class="confirmation-header">
      <div class="confirmation-icon">üéØ</div>
      <h2>Confirmar Sele√ß√£o Final</h2>
      <p>- Verifique se todos os picks e bans est√£o corretos antes de continuar</p>
    </div>

    <!-- Conte√∫do -->
    <div class="confirmation-content">
      <!-- Times lado a lado, igual √† tela principal -->
      <div class="teams-container">
        <!-- Time Azul -->
        <div class="team blue-team">
          <div class="team-header">
            <span class="team-name">üîµ Time Azul</span>
          </div>

          <!-- Bans do Time Azul -->
          <div class="team-bans">
            <div class="ban-slot" *ngFor="let ban of getTeamBans('blue'); let i = index">
              <img [src]="ban.image" [alt]="ban.name" class="ban-img">
              <span class="ban-name">{{ ban.name }}</span>
            </div>
            <!-- Slots vazios para completar 5 bans -->
            <div class="ban-slot empty-ban" *ngFor="let i of getEmptyBanSlots(getTeamBans('blue').length)">
              <div class="ban-placeholder">?</div>
              <span class="ban-name">Ban</span>
            </div>
          </div>

          <div class="team-picks">
            <div class="team-slot" *ngFor="let slot of getTeamByLane('blue'); let i = index">
              <div class="slot-content" [class.confirmed]="isPlayerConfirmed(slot.player)" [class.auto-confirmed]="isPlayerAutoConfirmed(slot.player)">
                <div class="player-info">
                  <span class="player-name">
                    {{ slot.player.summonerName || slot.player.name || 'Jogador' }}
                    <span class="you-indicator" *ngIf="isCurrentPlayer(slot.player)">(Voc√™)</span>
                  </span>
                  <span class="player-lane">{{ getPlayerLaneDisplayForPlayer(slot.player) }}</span>
                  <span class="confirmation-status" [class.confirmed]="isPlayerConfirmed(slot.player)" [class.pending]="!isPlayerConfirmed(slot.player)">
                    {{ getConfirmationStatus(slot.player) }}
                  </span>
                </div>
                <div class="champion-info" *ngIf="slot.champion">
                  <img [src]="slot.champion.image" [alt]="slot.champion.name" class="champion-img">
                  <span class="champion-name">{{ slot.champion.name }}</span>
                </div>
                <div class="champion-placeholder" *ngIf="!slot.champion">?</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Time Vermelho -->
        <div class="team red-team">
          <div class="team-header">
            <span class="team-name">üî¥ Time Vermelho</span>
          </div>

          <!-- Bans do Time Vermelho -->
          <div class="team-bans">
            <div class="ban-slot" *ngFor="let ban of getTeamBans('red'); let i = index">
              <img [src]="ban.image" [alt]="ban.name" class="ban-img">
              <span class="ban-name">{{ ban.name }}</span>
            </div>
            <!-- Slots vazios para completar 5 bans -->
            <div class="ban-slot empty-ban" *ngFor="let i of getEmptyBanSlots(getTeamBans('red').length)">
              <div class="ban-placeholder">?</div>
              <span class="ban-name">Ban</span>
            </div>
          </div>

          <div class="team-picks">
            <div class="team-slot" *ngFor="let slot of getTeamByLane('red'); let i = index">
              <div class="slot-content" [class.confirmed]="isPlayerConfirmed(slot.player)" [class.auto-confirmed]="isPlayerAutoConfirmed(slot.player)">
                <div class="player-info">
                  <span class="player-name">
                    {{ slot.player.summonerName || slot.player.name || 'Jogador' }}
                    <span class="you-indicator" *ngIf="isCurrentPlayer(slot.player)">(Voc√™)</span>
                  </span>
                  <span class="player-lane">{{ getPlayerLaneDisplayForPlayer(slot.player) }}</span>
                  <span class="confirmation-status" [class.confirmed]="isPlayerConfirmed(slot.player)" [class.pending]="!isPlayerConfirmed(slot.player)">
                    {{ getConfirmationStatus(slot.player) }}
                  </span>
                </div>
                <div class="champion-info" *ngIf="slot.champion">
                  <img [src]="slot.champion.image" [alt]="slot.champion.name" class="champion-img">
                  <span class="champion-name">{{ slot.champion.name }}</span>
                </div>
                <div class="champion-placeholder" *ngIf="!slot.champion">?</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- A√ß√µes -->
    <div class="confirmation-actions">
      <!-- ‚úÖ NOVO: Mostrar contagem de confirma√ß√µes -->
      <div class="confirmation-status-info" *ngIf="confirmationData?.confirmations">
        <p class="confirmation-count">
          {{ getConfirmationCount().confirmed }}/{{ getConfirmationCount().total }} jogadores confirmaram
        </p>
        <!-- ‚úÖ NOVO: Mostrar mensagem de estado -->
        <p class="confirmation-message" *ngIf="confirmationMessage" [class.error]="confirmationMessage.includes('Erro')">
          {{ confirmationMessage }}
        </p>
      </div>

      <button class="btn btn-danger btn-lg" (click)="cancelFinalDraft()" [disabled]="isConfirming">
        ‚ùå Cancelar Partida
      </button>
      <button class="btn btn-info btn-lg" (click)="refreshDraftState()" [disabled]="isConfirming">
        üîÑ Atualizar Estado do Draft
      </button>
      <button class="btn btn-secondary btn-lg" (click)="startEditingCurrentPlayer()" [disabled]="isConfirming">
        ‚úèÔ∏è Editar Minha Sele√ß√£o
      </button>
      <button class="btn btn-success btn-lg btn-confirm"
              (click)="confirmFinalDraft()"
              [disabled]="isConfirming"
              [class.loading]="isConfirming">
        <span *ngIf="!isConfirming">‚úÖ Confirmar Draft Final</span>
        <span *ngIf="isConfirming">‚è≥ Confirmando...</span>
      </button>
    </div>
  </div>
</div>
